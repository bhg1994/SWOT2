{"version":3,"file":"static/webpack/static\\development\\pages\\_app.js.6f87494f21f62542441a.hot-update.js","sources":["webpack:///./sagas/user.js"],"sourcesContent":["import {\n    all,\n    call,\n    fork,\n    put,\n    takeEvery\n} from 'redux-saga/effects';\nimport axios from 'axios';\nimport {\n    LOAD_USER_FAILURE,\n    LOAD_USER_REQUEST,\n    LOAD_USER_SUCCESS,\n    LOG_IN_FAILURE,\n    LOG_IN_REQUEST,\n    LOG_IN_SUCCESS,\n    LOG_OUT_FAILURE,\n    LOG_OUT_REQUEST,\n    LOG_OUT_SUCCESS,\n    SIGN_UP_FAILURE,\n    SIGN_UP_REQUEST,\n    SIGN_UP_SUCCESS,\n} from '../reducers/user';\n\nfunction logInAPI(loginData) {\n    // 서버에 요청을 보내는 부분\n    let form = new FormData()\n    form.append('email', loginData.id)\n    form.append('password', loginData.password)\n\n    return axios.post(`http://swot.devdogs.kr:8080/api/auth/signin`, form)\n        .then(response => {\n            console.log(\"id,password : \" + loginData.id, loginData.password);\n            console.log('response : ', JSON.stringify(response, null, 2));\n            var result = response.data;\n            console.log(result.accessToken);\n            return result;\n        })\n        .catch(error => {\n            console.log('failed', error)\n        })\n}\n\nfunction* logIn(action) {\n    try {\n        const result = yield call(logInAPI, action.data);\n        console.log(result.accessToken);\n        yield put({ // put은 dispatch 동일\n            type: LOG_IN_SUCCESS,\n        });\n        localStorage.setItem(\"accessToken\",result.accessToken);\n        localStorage.setItem(\"refreshToken\",result.refreshToken);\n\n\n    } catch (e) { // loginAPI 실패\n        console.error(e);\n        yield put({\n            type: LOG_IN_FAILURE,\n        });\n    }\n}\n\nfunction* watchLogIn() {\n    yield takeEvery(LOG_IN_REQUEST, logIn);\n}\n\nfunction signUpAPI(signUpData) {\n    console.log(signUpData);\n    // 서버에 요청을 보내는 부분\n    let form = new FormData()\n    form.append('email', signUpData.id)\n    form.append('password', signUpData.password)\n    form.append('name', signUpData.name)\n    form.append('phone', signUpData.telephone)\n\n    return axios.post(`http://swot.devdogs.kr:8080/api/auth/signup`, form)\n        .then(response => {\n            console.log('response : ', JSON.stringify(response, null, 2))\n        })\n        .catch(error => {\n            console.log('failed', error)\n        })\n}\n\nfunction* signUp(action) {\n    try {\n        // yield call(signUpAPI);\n        yield call(signUpAPI, action.data);\n        yield put({ // put은 dispatch 동일\n            type: SIGN_UP_SUCCESS,\n        });\n    } catch (e) { // loginAPI 실패\n        console.error(e);\n        yield put({\n            type: SIGN_UP_FAILURE,\n            error: e,\n        });\n    }\n}\n\nfunction* watchSignUp() {\n    yield takeEvery(SIGN_UP_REQUEST, signUp);\n}\n\nfunction logOutAPI() {\n    // 서버에 요청을 보내는 부분\n    return axios.post('/user/logout', {}, {\n        withCredentials: true,\n    });\n}\n\nfunction* logOut() {\n    try {\n        // yield call(logOutAPI);\n        yield call(logOutAPI);\n        yield put({ // put은 dispatch 동일\n            type: LOG_OUT_SUCCESS,\n        });\n    } catch (e) { // loginAPI 실패\n        console.error(e);\n        yield put({\n            type: LOG_OUT_FAILURE,\n            error: e,\n        });\n    }\n}\n\nfunction* watchLogOut() {\n    yield takeEvery(LOG_OUT_REQUEST, logOut);\n}\n\nfunction loadUserAPI() {\n    // 서버에 요청을 보내는 부분\n    return axios.get('/user/', {\n        withCredentials: true,\n    });\n}\n\nfunction* loadUser() {\n    try {\n        // yield call(loadUserAPI);\n        const result = yield call(loadUserAPI);\n        yield put({ // put은 dispatch 동일\n            type: LOAD_USER_SUCCESS,\n            data: result.data,\n        });\n    } catch (e) { // loginAPI 실패\n        console.error(e);\n        yield put({\n            type: LOAD_USER_FAILURE,\n            error: e,\n        });\n    }\n}\n\nfunction* watchLoadUser() {\n    yield takeEvery(LOAD_USER_REQUEST, loadUser);\n}\n\nexport default function* userSaga() {\n    yield all([\n        fork(watchLogIn),\n        fork(watchLogOut),\n        fork(watchLoadUser),\n        fork(watchSignUp),\n    ]);\n}"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AA0CA;;;AAmBA;;;AAsBA;;;AAgBA;;;AAWA;;;AAgBA;;;AAWA;;;AAiBA;;;AAIA;AACA;AA/JA;AAOA;AACA;AACA;AAcA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AAHA;AAEA;AACA;AAHA;AAIA;AAAA;AACA;AADA;AACA;AALA;AAOA;AACA;AARA;AAAA;AACA;AADA;AAAA;AAAA;AAWA;AACA;AAZA;AAaA;AACA;AADA;AACA;AAdA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAkBA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AAJA;AAAA;AAIA;AAAA;AACA;AADA;AACA;AALA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAOA;AACA;AARA;AASA;AACA;AACA;AAFA;AACA;AAVA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAeA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAGA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AAJA;AAAA;AAIA;AAAA;AACA;AADA;AACA;AALA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAOA;AACA;AARA;AASA;AACA;AACA;AAFA;AACA;AAVA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAeA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAGA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AAJA;AAGA;AAHA;AAIA;AAAA;AACA;AACA;AAFA;AACA;AALA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAQA;AACA;AATA;AAUA;AACA;AACA;AAFA;AACA;AAXA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAgBA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;A","sourceRoot":""}